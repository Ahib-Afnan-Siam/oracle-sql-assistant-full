{"openapi":"3.1.0","info":{"title":"Oracle SQL Assistant (RAG-enabled)","version":"2.0"},"paths":{"/health":{"get":{"summary":"Health","description":"Enhanced health check with quality metrics summary and token usage.","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/token-usage":{"get":{"summary":"Token Usage Report","description":"Get detailed token usage report for cost tracking.","operationId":"token_usage_report_token_usage_get","parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Hours"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/token-usage/reset":{"get":{"summary":"Reset Token Usage","description":"Reset token usage tracking.","operationId":"reset_token_usage_token_usage_reset_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/token-usage/detailed-logs":{"get":{"summary":"Get Detailed Token Logs","description":"Get detailed token usage logs.","operationId":"get_detailed_token_logs_token_usage_detailed_logs_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/token-usage/daily-summary":{"get":{"summary":"Get Daily Token Summary","description":"Get daily token usage summary.","operationId":"get_daily_token_summary_token_usage_daily_summary_get","parameters":[{"name":"date","in":"query","required":false,"schema":{"type":"string","title":"Date"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/token-usage/daily-cost":{"get":{"summary":"Get Daily Token Cost","description":"Get daily token usage cost estimate.","operationId":"get_daily_token_cost_token_usage_daily_cost_get","parameters":[{"name":"date","in":"query","required":false,"schema":{"type":"string","title":"Date"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/test":{"get":{"summary":"Test Endpoint","operationId":"test_endpoint_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/{path}":{"options":{"summary":"Options Handler","operationId":"options_handler__path__options","parameters":[{"name":"path","in":"path","required":true,"schema":{"type":"string","title":"Path"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chat":{"post":{"summary":"Chat Api","operationId":"chat_api_chat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Question"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}}}}},"/feedback":{"post":{"summary":"Post Feedback","operationId":"post_feedback_feedback_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeedbackIn"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/quality-metrics":{"get":{"summary":"Get Quality Metrics","description":"Step 5.2: Get comprehensive quality metrics including success rates and user satisfaction.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 24)\n    \nReturns:\n    Quality metrics report","operationId":"get_quality_metrics_quality_metrics_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/quality-metrics/success-rates":{"get":{"summary":"Get Success Rates","description":"Get specific success rate metrics for query understanding and SQL execution.\n\nArgs:\n    time_window: Time window in hours for analysis\n    \nReturns:\n    Success rate metrics","operationId":"get_success_rates_quality_metrics_success_rates_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/quality-metrics/user-satisfaction":{"get":{"summary":"Get User Satisfaction","description":"Get user satisfaction indicators including acceptance rates and feedback scores.\n\nArgs:\n    time_window: Time window in hours for analysis\n    \nReturns:\n    User satisfaction metrics","operationId":"get_user_satisfaction_quality_metrics_user_satisfaction_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/quality-metrics/test-system":{"get":{"summary":"Test Quality Metrics System Endpoint","description":"Test the quality metrics system end-to-end.\n\nArgs:\n    time_window: Time window in hours for testing (default: 1)\n    \nReturns:\n    Test results and diagnostics","operationId":"test_quality_metrics_system_endpoint_quality_metrics_test_system_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/training-data/test":{"get":{"summary":"Test Training Data Collection","description":"Test the training data collection system.\n\nReturns:\n    Test results and system status","operationId":"test_training_data_collection_training_data_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/training-data/status":{"get":{"summary":"Get Training Data Status","description":"Get current status of the training data collection system.\n\nReturns:\n    System status information","operationId":"get_training_data_status_training_data_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/learning/performance-comparison":{"get":{"summary":"Get Performance Comparison","description":"Phase 6: Get performance comparison between local and API models.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 24)\n    \nReturns:\n    Performance comparison metrics by query type","operationId":"get_performance_comparison_learning_performance_comparison_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/learning/model-strengths":{"get":{"summary":"Get Model Strengths","description":"Phase 6: Get model strengths by domain/query type.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 24)\n    \nReturns:\n    Model strengths by domain/query type","operationId":"get_model_strengths_learning_model_strengths_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/learning/user-preferences":{"get":{"summary":"Get User Preferences","description":"Phase 6: Get user preference patterns for different models.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 24)\n    \nReturns:\n    User preference patterns analysis","operationId":"get_user_preferences_learning_user_preferences_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/learning/insights":{"get":{"summary":"Get Learning Insights","description":"Phase 6: Get comprehensive learning insights from pattern analysis.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 24)\n    \nReturns:\n    Comprehensive learning insights","operationId":"get_learning_insights_learning_insights_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/learning/test-system":{"get":{"summary":"Test Learning System","description":"Phase 6: Test the continuous learning system end-to-end.\n\nArgs:\n    time_window: Time window in hours for testing (default: 24)\n    \nReturns:\n    Test results and diagnostics for continuous learning system","operationId":"test_learning_system_learning_test_system_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/learning/test-processor":{"get":{"summary":"Test Learning Processor","description":"Phase 6: Test the continuous learning system through the hybrid processor.\n\nArgs:\n    time_window: Time window in hours for testing (default: 24)\n    \nReturns:\n    Test results and diagnostics for continuous learning system via processor","operationId":"test_learning_processor_learning_test_processor_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":24,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/training-data/high-quality-samples":{"get":{"summary":"Get High Quality Samples","description":"Step 6.2: Identify high-quality samples for training data preparation.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 168 hours/1 week)\n    min_quality: Minimum quality score threshold for high-quality samples (default: 0.8)\n    \nReturns:\n    High-quality samples categorized by type","operationId":"get_high_quality_samples_training_data_high_quality_samples_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":168,"title":"Time Window"}},{"name":"min_quality","in":"query","required":false,"schema":{"type":"number","default":0.8,"title":"Min Quality"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/training-data/datasets/{dataset_type}":{"get":{"summary":"Get Training Dataset","description":"Step 6.2: Create training datasets for different domains.\n\nArgs:\n    dataset_type: Type of dataset to create ('manufacturing', 'oracle_sql', 'business_logic')\n    time_window: Time window in hours for analysis (default: 720 hours/30 days)\n    \nReturns:\n    Training dataset for the specified type","operationId":"get_training_dataset_training_data_datasets__dataset_type__get","parameters":[{"name":"dataset_type","in":"path","required":true,"schema":{"type":"string","title":"Dataset Type"}},{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":720,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/training-data/processor/high-quality-samples":{"get":{"summary":"Get Processor High Quality Samples","description":"Step 6.2: Identify high-quality samples through the hybrid processor.\n\nArgs:\n    time_window: Time window in hours for analysis (default: 168 hours/1 week)\n    min_quality: Minimum quality score threshold (default: 0.8)\n    \nReturns:\n    High-quality samples categorized by type","operationId":"get_processor_high_quality_samples_training_data_processor_high_quality_samples_get","parameters":[{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":168,"title":"Time Window"}},{"name":"min_quality","in":"query","required":false,"schema":{"type":"number","default":0.8,"title":"Min Quality"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/training-data/processor/datasets/{dataset_type}":{"get":{"summary":"Get Processor Training Dataset","description":"Step 6.2: Create training datasets through the hybrid processor.\n\nArgs:\n    dataset_type: Type of dataset to create ('manufacturing', 'oracle_sql', 'business_logic')\n    time_window: Time window in hours for analysis (default: 720 hours/30 days)\n    \nReturns:\n    Training dataset for the specified type","operationId":"get_processor_training_dataset_training_data_processor_datasets__dataset_type__get","parameters":[{"name":"dataset_type","in":"path","required":true,"schema":{"type":"string","title":"Dataset Type"}},{"name":"time_window","in":"query","required":false,"schema":{"type":"integer","default":720,"title":"Time Window"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/export/sql":{"get":{"summary":"Export Sql","description":"Export rows from V_TRAIN_SQL as CSV.","operationId":"export_sql_export_sql_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/export/summary":{"get":{"summary":"Export Summary","description":"Export rows from V_TRAIN_SUMMARY as CSV.","operationId":"export_summary_export_summary_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/upload-file":{"post":{"summary":"Upload File","description":"Upload a file for analysis.\n\nArgs:\n    file: The file to upload\n    request: FastAPI Request object for rate limiting\n    \nReturns:\n    File upload response with file metadata","operationId":"upload_file_upload_file_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_upload_file_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileUploadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/analyze-file":{"post":{"summary":"Analyze File","description":"Analyze an uploaded file using Google Gemini Flash 1.5.\n\nArgs:\n    request: File analysis request containing file ID and question\n    req: FastAPI Request object for rate limiting\n    \nReturns:\n    File analysis response with summary from Gemini Flash 1.5","operationId":"analyze_file_analyze_file_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileAnalysisRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/file-upload-status":{"get":{"summary":"Get File Upload Status","description":"Get current file upload status and rate limits for the user.\n\nArgs:\n    request: FastAPI Request object\n    \nReturns:\n    File upload status and rate limit information","operationId":"get_file_upload_status_file_upload_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/cleanup-expired-files":{"post":{"summary":"Cleanup Expired Files","description":"Cleanup expired files from storage (administrative endpoint).\n\nReturns:\n    Cleanup result","operationId":"cleanup_expired_files_cleanup_expired_files_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_upload_file_upload_file_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_file_upload_file_post"},"FeedbackIn":{"properties":{"turn_id":{"type":"integer","title":"Turn Id"},"task_type":{"type":"string","pattern":"^(sql|summary|overall)$","title":"Task Type"},"feedback_type":{"type":"string","pattern":"^(good|wrong|needs_improvement)$","title":"Feedback Type"},"sql_sample_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sql Sample Id"},"summary_sample_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Summary Sample Id"},"comment":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Comment"},"labeler_role":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Labeler Role","default":"end_user"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"}},"type":"object","required":["turn_id","task_type","feedback_type"],"title":"FeedbackIn"},"FileAnalysisRequest":{"properties":{"file_id":{"type":"string","title":"File Id"},"question":{"type":"string","title":"Question"}},"type":"object","required":["file_id","question"],"title":"FileAnalysisRequest"},"FileUploadResponse":{"properties":{"file_id":{"type":"string","title":"File Id"},"filename":{"type":"string","title":"Filename"},"size":{"type":"integer","title":"Size"},"content_type":{"type":"string","title":"Content Type"}},"type":"object","required":["file_id","filename","size","content_type"],"title":"FileUploadResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Question":{"properties":{"question":{"type":"string","title":"Question"},"selected_db":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Selected Db","default":""},"mode":{"type":"string","title":"Mode","default":"General"}},"type":"object","required":["question"],"title":"Question"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}